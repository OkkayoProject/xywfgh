<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>DRM Player</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.3/shaka-player.compiled.js"></script>
</head>
<body>
  <video id="video" width="100%" controls autoplay></video>
  <script>
    async function initPlayer() {
      const video = document.getElementById('video');
      const player = new shaka.Player(video);

      // ClearKey DRM config
      const keyId = '912760c409eb5aff3e060422c502f410';
      const key = 'bea2d0f89fb3fbafa1fc9f34ba8734a6';

      player.configure({
        drm: {
          clearKeys: {
            [keyId]: key
          }
        },
        streaming: {
          alwaysStreamText: true
        }
      });

      // Optional: Set custom user-agent headers via backend proxy if needed.
      // WebView tidak bisa ganti UA langsung via JS.

      try {
        await player.load('http://linearjitp-playback.astro.com.my/dash-wv/linear/711/default_primary.mpd');
        console.log('The video has now been loaded!');
      } catch (e) {
        console.error('Error loading video:', e);
      }
    }

    document.addEventListener('DOMContentLoaded', initPlayer);
  </script>
</body>
</html>
